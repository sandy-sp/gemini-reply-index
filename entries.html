<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>All Submissions</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <h1>Past Gemini Prompts</h1>
  <div id="list"></div>
  <script>
    const OWNER = 'sandy-sp';
    const REPO  = 'gemini-reply-index';

    async function listEntries() {
      const api = `https://api.github.com/repos/${OWNER}/${REPO}/contents/entries`;
      const res = await fetch(api);
      const items = await res.json();
      const container = document.getElementById('list');

      for (const dir of items) {
        if (dir.type !== 'dir') continue;
        const name = dir.name;
        // fetch prompt.txt
        const promptRes = await fetch(`${api}/${name}/prompt.txt`);
        const promptText = await promptRes.text();

        // find the .docx file
        const filesRes = await fetch(`${api}/${name}`);
        const files = await filesRes.json();
        const doc = files.find(f => f.name.endsWith('.docx'));

        const entryDiv = document.createElement('div');
        entryDiv.classList.add('entry');
        entryDiv.innerHTML = `
          <h2>Submission ${new Date(Number(name)).toLocaleString()}</h2>
          <pre>${promptText}</pre>
          ${doc ? `<a href="https://raw.githubusercontent.com/${OWNER}/${REPO}/main/entries/${name}/${doc.name}" target="_blank">
                     Download ${doc.name}
                   </a>` : ''}
        `;
        container.appendChild(entryDiv);
      }
    }

    listEntries();
  </script>
</body>
</html>
